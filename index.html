<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OpoVerbal - Entrena tu mente</title>
    
    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- REACT & REACT DOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- BABEL -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- ESTILOS PERSONALIZADOS Y FUENTES -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Quicksand:wght@600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; overscroll-behavior: none; }
        .font-round { font-family: 'Quicksand', sans-serif; }
        
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .slide-up { animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .bg-verbalopo {
            background: radial-gradient(circle at 50% 0%, #eff6ff 0%, #ffffff 100%);
        }
        
        ::-webkit-scrollbar { display: none; }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { opacity: 1; }
        
        .tooltip-arrow {
            width: 0; height: 0; 
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid #1e293b;
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
        }
        .native-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-color: transparent;
            text-align: center;
            text-align-last: center;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen w-screen overflow-hidden selection:bg-indigo-100">

    <div id="root" class="h-full w-full"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        /* ================= BASE DE DATOS ================= */
        const spellingDatabase = [
            {
                id: "hecho_echo",
                title: "HECHO / ECHO",
                content: (
                    <div className="space-y-6 text-sm">
                        <div>
                            <p className="mb-2 text-base"><span className="font-black text-blue-600">HECHO</span> (con H):</p>
                            <p className="mb-2 text-slate-700">Es el <strong>"hijo"</strong> del verbo <strong>hacer</strong>. Como su padre (<em>hacer</em>) lleva H, √©l es muy obediente y se la deja puesta siempre.</p>
                            <p className="mb-3 text-slate-700">Lo usamos cuando hablamos de algo que hemos fabricado, terminado o un suceso que ha ocurrido; es decir, cuando has <strong>creado</strong> algo.</p>
                            <ul className="list-disc pl-5 space-y-1 text-slate-600 mb-4 italic">
                                <li>"Ya he <strong>hecho</strong> todos los deberes de mates".</li>
                                <li>"El disfraz est√° <strong>hecho</strong> a mano".</li>
                            </ul>
                            <div className="bg-yellow-50 p-4 rounded-xl border border-yellow-200 flex gap-3 items-start shadow-sm">
                                <span className="text-2xl">üí°</span>
                                <div>
                                    <p className="font-bold underline decoration-yellow-500 underline-offset-2 mb-1 text-slate-800">EL TRUCO</p>
                                    <p className="italic text-slate-600">Si puedes cambiar la palabra por "realizado" o "fabricado", ¬°ponle la <strong>H</strong> sin miedo!</p>
                                </div>
                            </div>
                        </div>
                        <hr className="border-slate-100" />
                        <div>
                            <p className="mb-2 text-base"><span className="font-black text-blue-600">ECHO</span> (sin H):</p>
                            <p className="mb-2 text-slate-700">Viene del verbo <strong>echar</strong>, que significa tirar, lanzar, poner algo o expulsar.</p>
                            <p className="mb-3 text-slate-700">Para acordarte, piensa que este verbo es tan fuerte que <strong>ha echado la H a la basura</strong> y se ha quedado solo.</p>
                            <ul className="list-disc pl-5 space-y-1 text-slate-600 mb-4 italic">
                                <li>"Siempre <strong>echo</strong> los pl√°sticos al contenedor".</li>
                                <li>"Le <strong>echo</strong> mucha sal a las patatas".</li>
                            </ul>
                            <div className="bg-yellow-50 p-4 rounded-xl border border-yellow-200 flex gap-3 items-start shadow-sm">
                                <span className="text-2xl">üí°</span>
                                <div>
                                    <p className="font-bold underline decoration-yellow-500 underline-offset-2 mb-1 text-slate-800">EL TRUCO</p>
                                    <p className="italic text-slate-600">Apr√©ndete esta rima m√°gica: <em>"Lo primero que se echa al echar, es la hache"</em>.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                )
            },
            { id: "haber_aver", title: "HABER / A VER", content: `HABER: Verbo auxiliar o sustantivo (existencia).\nEj: 'Tiene que haber algo'. 'Su haber es grande'.\n\nA VER: Preposici√≥n 'a' + verbo 'ver'. Indica inter√©s, expectaci√≥n o comprobaci√≥n.\nEj: 'Voy a ver a mi abuela'. '¬°A ver si apruebas!'.` },
            { id: "hasta_asta", title: "HASTA / ASTA", content: "HASTA: Preposici√≥n.\nASTA: Cuerno o palo." },
            { id: "ha_a", title: "HA / A", content: "HA: Verbo haber.\nA: Preposici√≥n." },
            { id: "tu_tu", title: "TU / T√ö", content: "T√ö: Pronombre.\nTU: Posesivo." },
            { id: "hay_ahi_ay", title: "HAY / AH√ç / ¬°AY!", content: "HAY: Haber.\nAH√ç: Lugar.\n¬°AY!: Exclamaci√≥n." },
            { id: "el_el", title: "EL / √âL", content: "√âL: Pronombre.\nEL: Art√≠culo." },
            { id: "mas_mas", title: "MAS / M√ÅS", content: "M√ÅS: Cantidad.\nMAS: Pero." },
            { id: "mi_mi", title: "M√ç / MI", content: "M√ç: Pronombre.\nMI: Posesivo." },
            { id: "vaya_valla", title: "VAYA / VALLA", content: "VAYA: Verbo ir.\nVALLA: Cerca." },
            { id: "cayo_callo", title: "CAY√ì / CALL√ì", content: "CAY√ì: Caer.\nCALL√ì: Callar." },
            { id: "sino_sino", title: "SINO / SI NO", content: "SINO: Contraposici√≥n.\nSI NO: Condicional." },
            { id: "tambien_tanbien", title: "TAMBI√âN / TAN BIEN", content: "TAMBI√âN: Afirmaci√≥n.\nTAN BIEN: Comparaci√≥n." },
            { id: "tampoco_tanpoco", title: "TAMPOCO / TAN POCO", content: "TAMPOCO: Negaci√≥n.\nTAN POCO: Cantidad." }
        ];

        const questionsDatabase = [
            { id: 1, question: "Se√±ale qu√© palabra corresponde a la siguiente definici√≥n: \"Manantial que brota de la tierra.\"", options: [{ id: 'a', text: "Fontana" }, { id: 'b', text: "Riachuelo" }, { id: 'c', text: "Caudal" }, { id: 'd', text: "Pechina" }], correctAnswer: 'a', explanation: "La respuesta correcta es la a) Fontana. Como experto en el l√©xico espa√±ol, te confirmo que el Diccionario de la Real Academia Espa√±ola (DLE) define fontana simplemente como \"Perteneciente a la fuente\", y a su vez, la primera acepci√≥n de \"fuente\" es textualmente \"manantial de agua que brota de la tierra\"." },
            { id: 2, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra ENERVAR.", options: [{ id: 'a', text: "Menoscabar, disminuir algo no material. MELLAR" }, { id: 'b', text: "Poner nervioso." }, { id: 'c', text: "Estar subordinado a alguien o algo." }, { id: 'd', text: "Echar a perder cualquier asunto. ESTROPEAR" }], correctAnswer: 'b', explanation: "Enervar: Poner nervioso, excitar." },
            { id: 3, question: "Se√±ale cu√°l es el sin√≥nimo de la palabra ACERBO.", options: [{ id: 'a', text: "Alegre" }, { id: 'b', text: "Fam√©lico" }, { id: 'c', text: "Fat√≠dico" }, { id: 'd', text: "Desapacible" }], correctAnswer: 'd', explanation: "Acerbo: √Åspero, cruel, desapacible." },
            { id: 4, question: "Se√±ale el ant√≥nimo de: EF√çMERO", options: [{ id: 'a', text: "Fugaz" }, { id: 'b', text: "Duradero" }, { id: 'c', text: "Pasajero" }, { id: 'd', text: "Breve" }], correctAnswer: 'b', explanation: "Ef√≠mero: Pasajero. Ant√≥nimo: Duradero." },
            { id: 5, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra TRASTO.", options: [{ id: 'a', text: "Cosa in√∫til, estropeada, vieja o que estorba." }, { id: 'b', text: "Aparato viejo o que funciona mal." }, { id: 'c', text: "Poner dificultad u obst√°culo a la ejecuci√≥n de algo." }, { id: 'd', text: "Deslucido, estropeado por el uso." }], correctAnswer: 'a', explanation: "Trasto: Cosa in√∫til, estropeada o que estorba." },
            { id: 6, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra CHARRO.", options: [{ id: 'a', text: "Dicho de una cosa: Recargada de adornos, abigarrada." }, { id: 'b', text: "Aparato viejo o que funciona mal." }, { id: 'c', text: "Natural de M√©xico, pa√≠s de Am√©rica." }, { id: 'd', text: "Dicho de una persona: Del grupo √©tnico que habit√≥ el m√≠tico Aztl√°n." }], correctAnswer: 'a', explanation: "Charro: Recargado de adornos, abigarrado." },
            { id: 7, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra VICHAR.", options: [{ id: 'a', text: "Mirar, con real o aparente desinter√©s, las mercanc√≠as expuestas a la venta." }, { id: 'b', text: "Que carece de lucimiento." }, { id: 'c', text: "Persona aviesa, de malas intenciones." }, { id: 'd', text: "Animal peque√±o, especialmente un insecto." }], correctAnswer: 'a', explanation: "Vichar: Mirar las mercanc√≠as expuestas." },
            { id: 8, question: "Se√±ale qu√© palabra corresponde a la siguiente definici√≥n: \"Mentira, enga√±o, noticia falsa.\"", options: [{ id: 'a', text: "Patra√±a" }, { id: 'b', text: "Lampi√±a" }, { id: 'c', text: "Filfa" }, { id: 'd', text: "Lagoter√≠a" }], correctAnswer: 'c', explanation: "Filfa: Mentira, enga√±o, noticia falsa." },
            { id: 9, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra OBTEMPERAR.", options: [{ id: 'a', text: "Alcanzar, conseguir y lograr algo que se merece, solicita o pretende." }, { id: 'b', text: "Trastornar, conturbar o confundir las ideas, alucinar." }, { id: 'c', text: "Obedecer o asentir." }, { id: 'd', text: "Esconder, tapar, disfrazar, encubrir a la vista." }], correctAnswer: 'c', explanation: "Obtemperar: Obedecer o asentir." },
            { id: 10, question: "Se√±ale cu√°l es el sin√≥nimo de la palabra PROLIJO.", options: [{ id: 'a', text: "Extenso" }, { id: 'b', text: "Sucinto" }, { id: 'c', text: "Desordenado" }, { id: 'd', text: "Conciso" }], correctAnswer: 'a', explanation: "Prolijo: Largo, dilatado, extenso." },
            { id: 11, question: "Se√±ale qu√© definici√≥n es la que se corresponde con la palabra PARANG√ìN.", options: [{ id: 'a', text: "Pared o baranda que se pone para evitar ca√≠das." }, { id: 'b', text: "Comparaci√≥n o semejanza." }, { id: 'c', text: "En oratoria, discurso en alabanza." }, { id: 'd', text: "Cara disforme o fant√°stica." }], correctAnswer: 'b', explanation: "Parang√≥n: Comparaci√≥n o semejanza." },
            { id: 12, question: "¬øQu√© serie indica el orden alfab√©tico correcto?", options: [{ id: 'a', text: "premisa, preludio, prelusi√≥n, presagio, pretexto." }, { id: 'b', text: "preludio, prelusi√≥n, premisa, presagio, pretexto." }, { id: 'c', text: "preludio, premisa, prelusi√≥n, pretexto, presagio." }, { id: 'd', text: "premisa, presagio, preludio, prelusi√≥n, pretexto." }], correctAnswer: 'b', explanation: "Orden: 1. Preludio, 2. Prelusi√≥n, 3. Premisa, 4. Presagio, 5. Pretexto." },
            { id: 13, question: "Se√±ale la palabra que NO pertenece al grupo.", options: [{ id: 'a', text: "Vaso" }, { id: 'b', text: "Jarra" }, { id: 'c', text: "Botella" }, { id: 'd', text: "L√≠quido" }], correctAnswer: 'd', explanation: "L√≠quido es el contenido, los dem√°s son recipientes." },
            { id: 14, question: "Se√±ale qu√© palabra corresponde a: \"Que habla mucho o demasiado\".", options: [{ id: 'a', text: "Locuaz" }, { id: 'b', text: "Parco" }, { id: 'c', text: "T√≠mido" }, { id: 'd', text: "Elocuente" }], correctAnswer: 'a', explanation: "Locuaz: Que habla mucho." },
            { id: 15, question: "Se√±ale el sin√≥nimo de la palabra OPROBIO.", options: [{ id: 'a', text: "Indolencia" }, { id: 'b', text: "Inquina" }, { id: 'c', text: "Ignominia" }, { id: 'd', text: "Desagravio" }], correctAnswer: 'c', explanation: "Oprobio: Ignominia, deshonra." },
            { id: 16, question: "Se√±ale qu√© definici√≥n se corresponde con la palabra INEFABLE.", options: [{ id: 'a', text: "Seguro, cierto." }, { id: 'b', text: "Que no se puede borrar." }, { id: 'c', text: "Que no se puede explicar con palabras." }, { id: 'd', text: "Que no se puede evitar." }], correctAnswer: 'c', explanation: "Inefable: Que no se puede explicar con palabras." },
            { id: 17, question: "Se√±ale la palabra que NO pertenece al grupo.", options: [{ id: 'a', text: "Premisa" }, { id: 'b', text: "Inferencia" }, { id: 'c', text: "Hip√©rbole" }, { id: 'd', text: "Conclusi√≥n" }], correctAnswer: 'c', explanation: "Hip√©rbole es ret√≥rica; el resto es l√≥gica." },
            { id: 18, question: "¬øQu√© serie indica el orden alfab√©tico correcto?", options: [{ id: 'a', text: "Desacato, desafuero, desali√±o, desagravio." }, { id: 'b', text: "Desacato, desafuero, desagravio, desali√±o." }, { id: 'c', text: "Desafuero, desacato, desali√±o, desagravio." }, { id: 'd', text: "Desali√±o, desacato, desafuero, desagravio." }], correctAnswer: 'b', explanation: "Orden: Desacato, Desafuero, Desagravio, Desali√±o." },
            { id: 19, question: "Se√±ale qu√© palabra corresponde a: \"De poco aprecio o importancia\".", options: [{ id: 'a', text: "Somero" }, { id: 'b', text: "Venial" }, { id: 'c', text: "F√∫til" }, { id: 'd', text: "Superfluo" }], correctAnswer: 'c', explanation: "F√∫til: De poco aprecio o importancia." },
            { id: 20, question: "Se√±ale el ant√≥nimo de la palabra CONSPICUO.", options: [{ id: 'a', text: "Ilustre" }, { id: 'b', text: "Visible" }, { id: 'c', text: "Ignoto" }, { id: 'd', text: "Eximio" }], correctAnswer: 'c', explanation: "Conspicuo: Ilustre. Ant√≥nimo: Ignoto (desconocido)." },
            { id: 21, question: "ABULIA es a VOLUNTAD como...", options: [{ id: 'a', text: "Negligencia es a Cuidado" }, { id: 'b', text: "Riqueza es a Opulencia" }, { id: 'c', text: "Luz es a Penumbra" }, { id: 'd', text: "Imprudencia es a Irresponsabilidad" }], correctAnswer: 'a', explanation: "Relaci√≥n de carencia: Abulia es falta de voluntad." },
            { id: 22, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Desahucio" }, { id: 'b', text: "Ingerencia" }, { id: 'c', text: "Garaje" }, { id: 'd', text: "Herej√≠a" }], correctAnswer: 'b', explanation: "Se escribe INJERENCIA (con J)." },
            { id: 23, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Deshidratar" }, { id: 'b', text: "Exhuberante" }, { id: 'c', text: "Exhalar" }, { id: 'd', text: "Exhaustivo" }], correctAnswer: 'b', explanation: "EXUBERANTE va sin H." },
            { id: 24, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Prever" }, { id: 'b', text: "Entrever" }, { id: 'c', text: "Proveer" }, { id: 'd', text: "Preveer" }], correctAnswer: 'd', explanation: "No existe 'Preveer'. Es PREVER." },
            { id: 25, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Submarino" }, { id: 'b', text: "Suboficial" }, { id: 'c', text: "Subrealista" }, { id: 'd', text: "Subrayar" }], correctAnswer: 'c', explanation: "Se escribe SURREALISTA (del franc√©s)." },
            { id: 26, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Deshielo" }, { id: 'b', text: "Objeci√≥n" }, { id: 'c', text: "Sujecci√≥n" }, { id: 'd', text: "Direcci√≥n" }], correctAnswer: 'c', explanation: "Se escribe SUJECI√ìN (una sola C)." },
            { id: 27, question: "Indique palabra con ERROR ortogr√°fico:", options: [{ id: 'a', text: "Inocuo" }, { id: 'b', text: "Subacu√°tico" }, { id: 'c', text: "Innocuo" }, { id: 'd', text: "Surupio" }], correctAnswer: 'c', explanation: "INNOCUO es incorrecto. Es INOCUO." },
            { id: 28, question: "SIN√ìNIMO de PRECEPTIVO:", options: [{ id: 'a', text: "Opcional" }, { id: 'b', text: "Obligatorio" }, { id: 'c', text: "Previo" }, { id: 'd', text: "Aconsejable" }], correctAnswer: 'b', explanation: "Preceptivo: Obligatorio (por precepto)." },
            { id: 29, question: "ANT√ìNIMO de IND√ìMITO:", options: [{ id: 'a', text: "Salvaje" }, { id: 'b', text: "Rebelde" }, { id: 'c', text: "D√≥cil" }, { id: 'd', text: "Bravo" }], correctAnswer: 'c', explanation: "Ind√≥mito: Rebelde. Ant√≥nimo: D√≥cil." },
            { id: 30, question: "SIN√ìNIMO de DIRIMIR:", options: [{ id: 'a', text: "Discutir" }, { id: 'b', text: "Enredar" }, { id: 'c', text: "Resolver" }, { id: 'd', text: "Dividir" }], correctAnswer: 'c', explanation: "Dirimir: Resolver un conflicto." },
            { id: 31, question: "ANT√ìNIMO de VEHEMENTE:", options: [{ id: 'a', text: "Impetuoso" }, { id: 'b', text: "Sosegado" }, { id: 'c', text: "Apasionado" }, { id: 'd', text: "Violento" }], correctAnswer: 'b', explanation: "Vehemente: Impetuoso. Ant√≥nimo: Sosegado." },
            { id: 32, question: "SIN√ìNIMO de APLOMO:", options: [{ id: 'a', text: "Pesadez" }, { id: 'b', text: "Serenidad" }, { id: 'c', text: "Verticalidad" }, { id: 'd', text: "Arrogancia" }], correctAnswer: 'b', explanation: "En sentido figurado, aplomo significa serenidad, circunspecci√≥n y gravedad." },
            { id: 33, question: "ANT√ìNIMO de INOCUO:", options: [{ id: 'a', text: "Inofensivo" }, { id: 'b', text: "Perjudicial" }, { id: 'c', text: "As√©ptico" }, { id: 'd', text: "Inmune" }], correctAnswer: 'b', explanation: "Inocuo: Que no hace da√±o. Ant√≥nimo: Perjudicial." }
        ];

        // --- COMPONENTES ---

        // ILUSTRACI√ìN: CAJA INFORMATIVA CENTRAL (MEJORADA CON TEXTO DE IMAGEN)
        const InfoIllustration = () => (
            <div className="w-full flex flex-col items-center justify-center">
                {/* Fondo decorativo sutil */}
                <div className="absolute inset-0 flex items-center justify-center -z-10 opacity-[0.03] pointer-events-none select-none">
                    <span className="text-8xl font-black text-slate-900 tracking-tighter leading-none text-center">OPO<br/>MEC</span>
                </div>

                {/* Tarjeta Informativa con borde y sombra destacados */}
                <div className="bg-white border-4 border-slate-100 shadow-2xl rounded-[2rem] p-6 w-full max-w-[360px] flex flex-col justify-center">
                    {/* Lista sin T√≠tulo, como pidi√≥ el usuario */}
                    <ul className="space-y-4 font-bold text-lg leading-tight font-round"> 
                        <li className="flex items-start gap-3">
                            <div className="w-2.5 h-2.5 bg-blue-700 rounded-full mt-1.5 shrink-0 shadow-sm"></div>
                            <span className="text-blue-800">Domina el vocabulario: <span className="font-medium">Sin√≥nimos, ant√≥nimos y definiciones precisas.</span></span>
                        </li>
                        <li className="flex items-start gap-3">
                            <div className="w-2.5 h-2.5 bg-yellow-700 rounded-full mt-1.5 shrink-0 shadow-sm"></div>
                            <span className="text-yellow-800">Entrena la l√≥gica verbal: <span className="font-medium">Orden alfab√©tico y palabra intrusa.</span></span>
                        </li>
                        <li className="flex items-start gap-3">
                            <div className="w-2.5 h-2.5 bg-teal-700 rounded-full mt-1.5 shrink-0 shadow-sm"></div>
                            <span className="text-teal-800">Perfecciona tu ortograf√≠a: <span className="font-medium">Detecta errores y consolida las reglas.</span></span>
                        </li>
                         <li className="flex items-start gap-3">
                            <div className="w-2.5 h-2.5 bg-lime-700 rounded-full mt-1.5 shrink-0 shadow-sm"></div>
                            <span className="text-lime-800">Ampl√≠a tu l√©xico: <span className="font-medium">No te quedes en blanco ante palabras cultas.</span></span>
                        </li>
                    </ul>
                </div>
            </div>
        );

        // --- ICONOS UI ---
        const IconArrowLeft = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>;
        const IconBook = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>;
        const IconPlay = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="0"><polygon points="5 3 19 12 5 21 5 3"/></svg>;
        const IconTimer = () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="10" x2="14" y1="2" y2="2"/><line x1="12" x2="15" y1="14" y2="11"/><circle cx="12" cy="14" r="8"/></svg>;
        const IconCheck = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const IconX = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const IconHome = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>;
        const IconChevronRight = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>;
        const IconRefresh = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></svg>;

        function App() {
            const [screen, setScreen] = useState('welcome');
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [selectedOption, setSelectedOption] = useState(null);
            const [isAnswered, setIsAnswered] = useState(false);
            const [score, setScore] = useState(0);
            const [timeLeft, setTimeLeft] = useState(30);
            const [activeQuestions, setActiveQuestions] = useState([]);
            const [selectedSpellingTopic, setSelectedSpellingTopic] = useState(null);
            const [questionCount, setQuestionCount] = useState(5);
            const [usedQuestionIds, setUsedQuestionIds] = useState([]);

            useEffect(() => {
                if (screen !== 'quiz' || isAnswered) return;
                const timer = setInterval(() => {
                    setTimeLeft((prev) => {
                        if (prev <= 1) {
                            setIsAnswered(true);
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);
                return () => clearInterval(timer);
            }, [currentQuestionIndex, screen, isAnswered]);

            const handleQuestionCountChange = (e) => {
                const val = e.target.value;
                setQuestionCount(parseInt(val));
            };

            const startQuiz = () => {
                let count = questionCount;
                const totalAvailableInDB = questionsDatabase.length;
                const questionsNeeded = Math.min(count, totalAvailableInDB);
                let availableQuestions = questionsDatabase.filter(q => !usedQuestionIds.includes(q.id));
                if (availableQuestions.length < questionsNeeded) {
                    availableQuestions = [...questionsDatabase];
                    setUsedQuestionIds([]); 
                }
                let shuffled = shuffleArray(availableQuestions);
                const selectedQuestions = shuffled.slice(0, questionsNeeded);
                if (availableQuestions.length === totalAvailableInDB && usedQuestionIds.length > 0) {
                     setUsedQuestionIds(selectedQuestions.map(q => q.id));
                } else {
                     if (availableQuestions.length === totalAvailableInDB) {
                         setUsedQuestionIds(selectedQuestions.map(q => q.id));
                     } else {
                         setUsedQuestionIds(prev => [...prev, ...selectedQuestions.map(q => q.id)]);
                     }
                }
                setActiveQuestions(selectedQuestions);
                setScreen('quiz');
                setCurrentQuestionIndex(0);
                setScore(0);
                setIsAnswered(false);
                setSelectedOption(null);
                setTimeLeft(30);
            };

            const restartSameQuiz = () => {
                setCurrentQuestionIndex(0);
                setScore(0);
                setIsAnswered(false);
                setSelectedOption(null);
                setTimeLeft(30);
                setScreen('quiz');
            };

            const goHome = () => {
                setScreen('welcome');
            };

            const goToSpellingMenu = () => {
                setScreen('spelling_menu');
            };

            const openSpellingTopic = (topic) => {
                setSelectedSpellingTopic(topic);
                setScreen('spelling_detail');
            };

            const handleOptionSelect = (optionId) => {
                if (isAnswered) return;
                setSelectedOption(optionId);
                setIsAnswered(true);
                if (optionId === activeQuestions[currentQuestionIndex].correctAnswer) {
                    setScore(score + 1);
                }
            };

            const nextQuestion = () => {
                if (currentQuestionIndex < activeQuestions.length - 1) {
                    setCurrentQuestionIndex(currentQuestionIndex + 1);
                    setSelectedOption(null);
                    setIsAnswered(false);
                    setTimeLeft(30);
                } else {
                    setScreen('results');
                }
            };

            // --- PANTALLAS ---
            if (screen === 'welcome') {
                return (
                    // CONTENEDOR PRINCIPAL: Flex Columna, Anclado Arriba (justify-start), Gap fijo
                    <div className="h-full w-full bg-verbalopo flex flex-col items-center justify-start gap-5 p-4 pt-4 relative overflow-hidden font-sans"> {/* pt-4 (1rem/16px) y gap-5 (20px) fijo */}
                        
                        {/* 1. T√çTULO */}
                        <div className="text-center flex-none">
                            <h1 className="text-5xl font-extrabold text-slate-900 mb-1 tracking-tight leading-tight">OpoVerbal</h1>
                            <p className="text-lg text-slate-600 font-medium leading-snug">Potencia la parte verbal de tu psicot√©cnico</p>
                        </div>

                        {/* 2. CAJA CENTRAL (Ilustraci√≥n) */}
                        <div className="w-full flex justify-center flex-none">
                             <InfoIllustration />
                        </div>

                        {/* 3. BOTONES INFERIORES */}
                        <div className="w-full max-w-sm flex-none pb-8">
                            <div className="flex justify-between items-center mb-3 gap-4">
                                <button onClick={goToSpellingMenu} className="flex-1 bg-white border border-slate-200 shadow-sm rounded-xl py-2 px-3 flex items-center justify-center gap-2 text-slate-600 font-bold text-sm hover:bg-slate-50 active:scale-95 transition-all h-10">
                                    <IconBook /> Ortograf√≠a
                                </button>
                                <div className="flex-1 bg-white border border-slate-200 shadow-sm rounded-xl py-1 px-2 flex flex-col items-center justify-center relative group h-10">
                                    <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wider leading-none">N¬∫ Preguntas</span>
                                    <div className="relative flex items-center justify-center w-full h-5">
                                        <select value={questionCount} onChange={handleQuestionCountChange} className="absolute inset-0 w-full h-full opacity-0 z-10 native-select cursor-pointer">
                                            {Array.from({ length: questionsDatabase.length }, (_, i) => i + 1).map(num => (
                                                <option key={num} value={num}>{num}</option>
                                            ))}
                                        </select>
                                        <div className="text-xl font-black text-indigo-600 pointer-events-none leading-none">{questionCount}</div>
                                    </div>
                                    <div className="absolute bottom-full mb-2 left-1/2 -translate-x-1/2 hidden group-hover:block w-32 bg-slate-800 text-white text-[10px] p-2 rounded-lg shadow-lg z-50 text-center leading-tight animate-in fade-in zoom-in duration-200">
                                        Aqu√≠ eliges la cantidad de preguntas del test
                                        <div className="tooltip-arrow"></div>
                                    </div>
                                </div>
                            </div>
                            <div className="flex justify-center">
                                <button 
                                    onClick={startQuiz}
                                    className="px-8 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-lg font-bold rounded-full shadow-xl shadow-indigo-500/20 transform transition active:scale-95 flex items-center justify-center gap-2"
                                >
                                    <div className="bg-white/20 p-1 rounded-full"><IconPlay /></div>
                                    <span>Empezar a practicar</span>
                                </button>
                            </div>
                            <div className="mt-4 text-center text-[11px] text-slate-400 font-medium">(c) manu-sansano v4.1</div>
                        </div>
                    </div>
                );
            }

            if (screen === 'spelling_menu') {
                return (
                    <div className="h-full w-full bg-slate-50 flex flex-col font-sans fade-in">
                        <div className="bg-white shadow-sm px-4 py-4 flex items-center gap-3 z-10">
                            <button onClick={goHome} className="p-2 -ml-2 rounded-full hover:bg-slate-100 text-slate-600"><IconArrowLeft /></button>
                            <h2 className="text-xl font-black text-slate-800 tracking-tight">ORTOGRAF√çA</h2>
                        </div>
                        <div className="flex-1 overflow-y-auto p-4">
                            <div className="grid grid-cols-2 gap-3 pb-4">
                                {spellingDatabase.map((topic) => (
                                    <button key={topic.id} onClick={() => openSpellingTopic(topic)} className="bg-white p-3 rounded-xl shadow-sm border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all text-center active:scale-[0.98] flex items-center justify-center min-h-[70px]">
                                        <span className="text-sm font-bold text-slate-700 uppercase leading-tight">{topic.title}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            if (screen === 'spelling_detail' && selectedSpellingTopic) {
                return (
                    <div className="h-full w-full bg-slate-50 flex flex-col font-sans slide-up">
                        <div className="bg-white shadow-sm px-4 py-4 flex items-center gap-3 z-10">
                            <button onClick={() => setScreen('spelling_menu')} className="p-2 -ml-2 rounded-full hover:bg-slate-100 text-slate-600"><IconArrowLeft /></button>
                            <h2 className="text-lg font-black text-slate-800 tracking-tight truncate">{selectedSpellingTopic.title}</h2>
                        </div>
                        <div className="flex-1 overflow-y-auto p-4 pt-2">
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-100 p-6">
                                {typeof selectedSpellingTopic.content === 'string' ? (
                                    <div className="prose prose-slate text-base leading-relaxed whitespace-pre-line text-slate-700">{selectedSpellingTopic.content}</div>
                                ) : (
                                    <div className="text-slate-700 text-base leading-relaxed">{selectedSpellingTopic.content}</div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            if (screen === 'results') {
                return (
                    <div className="h-full w-full bg-verbalopo flex flex-col items-center justify-center p-6 fade-in">
                        <div className="bg-white rounded-3xl shadow-lg p-8 w-full max-w-sm text-center border border-slate-100">
                            <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4"><span className="text-3xl">üèÜ</span></div>
                            <h2 className="text-2xl font-bold text-slate-800 mb-1">¬°Test Finalizado!</h2>
                            <p className="text-sm text-slate-500 mb-6">Aqu√≠ tienes tu puntuaci√≥n final</p>
                            <div className="flex items-baseline justify-center gap-1 mb-8">
                                <span className="text-6xl font-black text-blue-600 tracking-tighter">{score}</span>
                                <span className="text-xl text-slate-400 font-medium">/ {activeQuestions.length}</span>
                            </div>
                            <div className="space-y-3 w-full">
                                <button onClick={startQuiz} className="w-full bg-blue-600 text-white py-3 rounded-xl font-bold shadow-md active:scale-95 transition-transform flex items-center justify-center gap-2"><IconPlay /> Nuevo Test</button>
                                <button onClick={restartSameQuiz} className="w-full bg-slate-800 text-white py-3 rounded-xl font-bold shadow-md active:scale-95 transition-transform flex items-center justify-center gap-2"><IconRefresh /> Repetir Test</button>
                                <button onClick={goHome} className="w-full bg-white text-slate-500 border-2 border-slate-100 py-3 rounded-xl font-bold hover:bg-slate-50 active:scale-95 transition-transform flex items-center justify-center gap-2"><IconHome /> Volver al Inicio</button>
                            </div>
                        </div>
                    </div>
                );
            }

            const currentQuestion = activeQuestions[currentQuestionIndex];
            return (
                <div className="h-full w-full bg-slate-50 flex flex-col items-center font-sans fade-in">
                    <div className="w-full max-w-md bg-white shadow-sm z-10 px-4 py-3 flex items-center justify-between shrink-0">
                        <button onClick={goHome} className="p-2 -ml-2 rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors"><IconHome /></button>
                        <span className="text-xl font-black text-slate-700 tracking-wide">OpoVerbal</span>
                        <div className={`flex items-center gap-1 px-2.5 py-1 rounded-full font-mono font-bold text-sm ${timeLeft < 10 ? 'bg-red-50 text-red-500' : 'bg-slate-100 text-slate-600'}`}><IconTimer /> {timeLeft}s</div>
                    </div>
                    <div className="w-full max-w-md flex-1 overflow-y-auto p-4 flex flex-col">
                        <div className="mb-3"><span className="inline-block px-3 py-1 bg-blue-100 text-blue-700 text-[10px] font-extrabold rounded-full tracking-wider">PREGUNTA {currentQuestionIndex + 1} DE {activeQuestions.length}</span></div>
                        <h3 className="text-lg font-bold text-slate-800 leading-snug mb-5">{currentQuestion.question}</h3>
                        <div className="space-y-2.5 mb-2">
                            {currentQuestion.options.map((option) => {
                                const isSelected = selectedOption === option.id;
                                const isCorrect = option.id === currentQuestion.correctAnswer;
                                let containerClass = "border border-slate-200 bg-white shadow-sm hover:border-blue-300";
                                let textClass = "text-slate-600 font-medium";
                                let circleClass = "bg-slate-100 text-slate-400 font-bold";
                                let circleContent = option.id.toUpperCase();
                                if (isAnswered) {
                                    if (isCorrect) {
                                        containerClass = "border-green-200 bg-green-50 ring-1 ring-green-200";
                                        textClass = "text-green-800 font-semibold";
                                        circleClass = "bg-green-500 text-white";
                                        circleContent = <IconCheck />;
                                    } else if (isSelected && !isCorrect) {
                                        containerClass = "border-red-200 bg-red-50 ring-1 ring-red-200";
                                        textClass = "text-red-800";
                                        circleClass = "bg-red-500 text-white";
                                        circleContent = <IconX />;
                                    } else {
                                        containerClass = "border-slate-100 opacity-50 bg-slate-50";
                                    }
                                } else if (isSelected) {
                                    containerClass = "border-2 border-gray-900 bg-transparent";
                                    textClass = "text-gray-900 font-semibold";
                                    circleClass = "bg-gray-900 text-white";
                                }
                                return (
                                    <button key={option.id} onClick={() => handleOptionSelect(option.id)} disabled={isAnswered} className={`w-full text-left py-2.5 px-3 rounded-xl transition-all duration-200 flex items-center gap-3 active:scale-[0.99] ${containerClass}`}>
                                        <div className={`w-7 h-7 rounded-full flex items-center justify-center text-xs shrink-0 transition-colors ${circleClass}`}>{circleContent}</div>
                                        <span className={`text-base leading-tight ${textClass}`}>{option.text}</span>
                                    </button>
                                );
                            })}
                        </div>
                        {isAnswered && (
                            <div className="mt-1 pt-2 slide-up">
                                <div className="bg-white p-4 rounded-xl border border-slate-200 shadow-sm mb-3">
                                    <div className="flex gap-2.5">
                                        <div className="mt-0.5 text-blue-500 shrink-0"><IconCheck /></div>
                                        <div>
                                            <p className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1">Explicaci√≥n</p>
                                            <p className="text-sm text-slate-600 leading-relaxed">{currentQuestion.explanation}</p>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex justify-center">
                                    <button onClick={nextQuestion} className="bg-blue-600 text-white font-bold py-3 px-8 rounded-full shadow-lg shadow-blue-200 active:bg-blue-700 active:scale-[0.98] transition-all flex items-center gap-2">
                                        {currentQuestionIndex < activeQuestions.length - 1 ? 'Siguiente Pregunta' : 'Ver Resultados'}
                                        <IconChevronRight />
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
